---
title: "Data Analysis of Surface Change Rates"
format: html
toc: true
page-layout: full
execute:
  echo: false
  message: false
  warning: false
---

```{r}
library(tidyverse)
library(plotly)
library(DT)


car_data <- read_csv("data/Sport-car.csv") # Update with your actual file name


library(plotly)

plot_ly(
  data = car_data,
  x = ~Horsepower,
  y = ~`Price (in USD)`,
  type = 'scatter',
  mode = 'markers',
  color = ~`Car Make`, 
  text = ~paste(
    "<b>Make:</b>", `Car Make`, "<br>",
    "<b>Model:</b>", `Car Model`, "<br>",
    "<b>Year:</b>", Year, "<br>",
    "<b>Horsepower:</b>", Horsepower, "<br>",
    "<b>Price:</b> $", format(`Price (in USD)`, big.mark = ",")
  ),
  marker = list(size = 12, opacity = 0.85, line = list(width = 1, color = "#ffffff"))
) %>%
  layout(
    title = list(text = "üí∞ Price vs Horsepower", x = 0.5),
    xaxis = list(title = "Horsepower (hp)", gridcolor = "#eeeeee"),
    yaxis = list(title = "Price (USD)", tickprefix = "$", gridcolor = "#eeeeee"),
    plot_bgcolor = "#f9f9f9",
    paper_bgcolor = "#f9f9f9"
  )


library(ggplot2)
library(scales)

car_data %>%
  group_by(`Car Make`) %>%
  summarise(Average_Price = mean(`Price (in USD)`, na.rm = TRUE)) %>%
  ggplot(aes(x = reorder(`Car Make`, Average_Price), y = Average_Price, fill = `Car Make`)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  scale_y_continuous(labels = dollar_format()) +
  theme_minimal(base_size = 14) +
  labs(
    title = "üìà Average Car Price by Make",
    x = "",
    y = "Average Price (USD)"
  ) +
  scale_fill_viridis_d()



plot_ly(
  data = car_data,
  x = ~`0-60 MPH Time (seconds)`,
  y = ~`Price (in USD)`,
  color = ~`Car Make`,
  type = "scatter",
  mode = "markers",
  marker = list(size = 10, opacity = 0.9),
  text = ~paste(
    "<b>Make:</b>", `Car Make`, "<br>",
    "<b>Model:</b>", `Car Model`, "<br>",
    "<b>0-60 Time:</b>", `0-60 MPH Time (seconds)`, " sec", "<br>",
    "<b>Price:</b> $", format(`Price (in USD)`, big.mark = ",")
  )
) %>%
  layout(
    title = list(text = "‚ö°Ô∏è Price vs 0‚Äì60 MPH Time", x = 0.5),
    xaxis = list(title = "0‚Äì60 MPH Time (Seconds)", gridcolor = "#f0f0f0"),
    yaxis = list(title = "Price (USD)", tickprefix = "$", gridcolor = "#f0f0f0"),
    plot_bgcolor = "#fcfcfc",
    paper_bgcolor = "#fcfcfc"
  )



ggplot(car_data, aes(x = `Car Make`, y = `Price (in USD)`, fill = `Car Make`)) +
  geom_boxplot(alpha = 0.8, outlier.color = "red", outlier.size = 2) +
  scale_y_continuous(labels = dollar_format()) +
  coord_flip() +
  theme_minimal(base_size = 14) +
  labs(
    title = "üì¶ Price Distribution by Car Make",
    x = "",
    y = "Price (USD)"
  ) +
  theme(legend.position = "none") +
  scale_fill_viridis_d()

```
